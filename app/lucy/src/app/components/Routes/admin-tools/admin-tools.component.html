<div class=" admin-container">

<!-- Header Section -->
  <div class="container-fluid header-container">
    <div class="container">
      <mat-toolbar class="toolbar">
        <mat-toolbar-row>
          <span class="animated fadeIn">Admin Tools</span>
        </mat-toolbar-row>
      </mat-toolbar>
    </div>
  </div>
  <br />
  <div class="container">

    <!-- Data managment-->
    <div class="row box">
      <div class="col-12 section-title-text">
        Manage Data
      </div>
      <div class="col-12">
        <hr class="section-divider" />
      </div>
      <div class="col-12 col-sm-6 col-lg-10 section-body-text">
        There are currently {{numberOfDataInInspectAppToExport}} records in the Inspect App Database.
      </div>
      <div class="col-12 col-sm-6 col-lg-2">
        <button mat-raised-button class="action-button" color="primary" (click)="export()"> Export All Data </button>
      </div>
    </div>
    <!-- End Data managment -->

    <br />

    <span class="row box">

      <!-- Requests -->
      <div class="col-12">
        <div class="section-title-text">
          Pending Access Requests
        </div>
        <hr class="section-divider" />
        <div *ngIf="hasRequests">
          <table mat-table [dataSource]="requestUsersDataSource">

            <!--Username Column -->
            <ng-container matColumnDef="username">
              <th mat-header-cell *matHeaderCellDef class="table-first-column">
                  Username
              </th>
              <td mat-cell *matCellDef="let item"> {{item.username}} </td>
            </ng-container>

            <!-- Name Column -->
            <ng-container matColumnDef="name">
              <th mat-header-cell *matHeaderCellDef>
                  Name
              </th>
              <td mat-cell *matCellDef="let item"> {{item.name}} </td>
            </ng-container>

            <!-- Requested role Column -->
            <ng-container matColumnDef="roleRequested">
              <th mat-header-cell *matHeaderCellDef>
                  Requested Role
              </th>
              <td mat-cell *matCellDef="let item"> {{item.roleRequested}} </td>
            </ng-container>

            <!-- Reason Column -->
            <ng-container matColumnDef="reason">
              <th mat-header-cell *matHeaderCellDef>
                  Reason
              </th>
              <td mat-cell *matCellDef="let item"> {{item.reason}} </td>
            </ng-container>

            <!-- Action column -->
            <ng-container matColumnDef="actions">
              <th mat-header-cell *matHeaderCellDef></th>
              <td mat-cell *matCellDef>
                <button mat-raised-button color="primary">
                  Respond
                </button>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="requestUsersColumns" class="table-header"></tr>
            <tr mat-row *matRowDef="let row; columns: requestUsersColumns"></tr>
          </table>
        </div>
        <div class="col-12" *ngIf="!hasRequests">
          There are currently no new requests
        </div>
      </div>
      <!-- End Requests -->
      <span class="section-space"></span>
      <!-- All Users -->
      <div class="col-12">
        <div class="section-title-text">
          All Users
        </div>
        <hr class="section-divider" />
        <div *ngIf="hasUsers">
          <table mat-table [dataSource]="usersDataSource">

            <!--Username Column -->
            <ng-container matColumnDef="username">
              <th mat-header-cell *matHeaderCellDef class="table-first-column">
                  Username
              </th>
              <td mat-cell *matCellDef="let item"> {{item.username}} </td>
            </ng-container>

            <!-- Name Column -->
            <ng-container matColumnDef="name">
              <th mat-header-cell *matHeaderCellDef>
                  Name
              </th>
              <td mat-cell *matCellDef="let item"> {{item.name}} </td>
            </ng-container>

            <!-- Email Column -->
            <ng-container matColumnDef="email">
              <th mat-header-cell *matHeaderCellDef>
                  Email
              </th>
              <td mat-cell *matCellDef="let item"> {{item.email}} </td>
            </ng-container>

            <!-- Role Column -->
            <ng-container matColumnDef="role">
              <th mat-header-cell *matHeaderCellDef>
                  Role
              </th>
              <td mat-cell *matCellDef="let item"> {{item.role}} </td>
            </ng-container>

            <!-- Action column -->
            <ng-container matColumnDef="actions">
              <th mat-header-cell *matHeaderCellDef></th>
              <td mat-cell *matCellDef="let item">
                <button mat-stroked-button color="primary" (click)="onUserAction(item)">
                  Actions
                </button>
                <mat-card *ngIf="showUserPopper(item)" class="popper">
                  <div class="popper-container">
                    <p class="popper-header">User Actions</p>
                    <hr class="popper-header-divider" />
                    <mat-form-field class="popper-dropdown">
                      <mat-label>Role</mat-label>
                      <mat-select [(ngModel)]="getUserRole" (selectionChange)="changeUserRole($event)">
                        <mat-option *ngFor="let role of activeRoles" [value]="role.role">
                          {{role.role}}
                        </mat-option>
                      </mat-select>
                    </mat-form-field>
                    <div class="popper-status-container">
                      <p>Account Active</p>
                      <mat-slide-toggle color="primary"></mat-slide-toggle>
                    </div>
                    <hr class="popper-footer-divider" />
                    <button mat-raised-button color="primary" class="popper-footer-button">
                      Remove User
                    </button>
                  </div>
                </mat-card>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="usersColumns" class="table-header"></tr>
            <tr mat-row *matRowDef="let row; columns: usersColumns"></tr>
          </table>
        </div>
        <div class="col-12" *ngIf="!hasUsers">
          There are currently no users
        </div>
      </div>
      <!-- End Users -->
    </span>
  </div>
</div>